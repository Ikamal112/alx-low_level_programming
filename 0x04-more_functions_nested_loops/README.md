more fxns and nested loops
